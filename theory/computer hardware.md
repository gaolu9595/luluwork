# Computer Hardware

[TOC]

## SSD & HDD

1、**SSD是固态硬盘**（Solid State Drives），简称固盘；**HDD是机械硬盘**；两者最大区别是固态硬盘由多个闪存颗粒和主控芯片组成，没有运动结构设计，而机械硬盘采用的是碟盘和读写磁头组成；

2、**固态硬盘读写速度快**：采用闪存作为存储介质，读取速度相对机械硬盘更快。**磁盘读写最慢的地方在于寻道**，固态硬盘不用磁头，寻道时间几乎为0，持续写入的速度较高；

3、**固态硬盘防震抗摔性好**：传统硬盘都是磁碟型的，数据储存在磁碟扇区里。而固态硬盘是使用闪存颗粒（即mp3、U盘等存储介质）制作而成，所以SSD固态硬盘内部不存在任何机械部件；这样即使在高速移动甚至伴随翻转倾斜的情况下也不会影响到正常使用，而且在发生碰撞和震荡时能够将数据丢失的可能性降到最小。相较传统硬盘，固态硬盘占有绝对优势；

4、**固态硬盘低功耗**：固态硬盘的功耗上要低于传统硬盘；固态硬盘无噪音：固态硬盘没有机械马达和风扇，工作时噪音值为0分贝。基于闪存的固态硬盘在工作状态下能耗和发热量较低（但高端或大容量产品能耗会较高）。内部不存在任何机械活动部件，不会发生机械故障，也不怕碰撞、冲击、振动。由于固态硬盘采用无机械部件的闪存芯片，所以具有了发热量小、散热快等特点；

5、**固态硬盘的缺点是容量小，寿命有限，售价高**；



## 磁盘的读写

### 什么是随机读写，什么是顺序读写，哪个快？

举个例子，你有一本记事本（磁盘），你要往里面记录一些文字（写数据）。假设要写一页文字。

**顺序读写**：你翻开记事本，找到连续空白够一页的地方，能连续记录下我这次要记录的内容，往后写就行了（顺序写）。

**随机读写**：你翻开记事本，找不到完整的能记录下这一页的地方，那就随便找空白的地方记录吧，第一页还有半页没写，那就在第一页记录一半，然后找第二个有空白的地方，第二页有1/4空白，第三页有1/4空白，那就在第二页和第三页分别记录剩下的一半内容，记录速度明显变慢了。

所以，**顺序读写速率明显要高于随机读写**。

### 为什么会有随机读写和顺序读写这两种方式？直接用顺序读写不行吗？

因为一开始新磁盘，数据都是顺序写，忽然有一天你删一部小电影，磁盘空出一点来了，但是这空出来的空间不连续了，但这也是你的磁盘空闲空间，也得利用起来，所以就会有随机读写了，这存一点，那存一点，磁头寻址多花点时间。

## 内存分配

### 为什么磁盘要分块？

我们知道对于HDD来说，其硬件最小的读写单位是扇区（读写粒度 512字节）。而一般HDD的容量大，文件系统若按扇区为读写粒度**并不方便(这种表述并不具体)。**而且由于磁盘IO性能的瓶颈，细粒度的读写既低效，也会损害磁盘的寿命。因此文件系统对磁盘的读写是将多个扇区看做一个块（这个概念在windows中被称为簇）。文件系统以块大小为单位对磁盘进行读写。块大小一般为扇区的2的n次方倍。（不固定，现在也出现了大小为4kB的扇区）。

### 为什么内存要分页？

内存相对于磁盘是个高性能存储设备，物理上内存是按字节寻址的。分页这个概念出现在虚拟内存中。虚拟内存的意义是：对于每个进程来说，他们拥有内存（虚拟）空间是大且连续的。而这些大且连续的虚拟内存对应在物理内存上的位置是离散分布的。其中的映射关系被称为页表。但即便这样为什么要分页呢？直接按字节把每个虚拟内存地址和物理内存地址一一对应不行么?我的答案是：这么做理论上不会产生内存碎片，因为粒度足够小，但这需要维护一个巨大的映射关系表。 而且现代处理器都采用多进程共享内存资源，每个进程都需要建立和维护属于自己的页表。这样的页表的存储空间开销会很大。因此操作系统把虚拟内存分为一定大小的页面（一般4096B）。物理内存相应划分为一定大小的页面帧。据此，虚拟地址划分为虚拟页号+页内偏移，物理地址划分为页帧号+页内偏移。这样形成的页表较为精简，方便管理，做虚拟页号与页帧号之间的映射。而页大小也不能过大，这样在实际物理内存上可能会产生小于一个页大小的内存碎片。

### 为什么缓存要有cacheline？

缓存比内存性能还好，那不更有理由以字节为读写粒度了么？应该这么理解，缓存设置的目的是为了弥补不同速率设备间的性能差异，其原理是利用访存的局部性。而存储一段连续的内存块（这里的内存块也是个逻辑概念，且仅存在于缓存逻辑中，与磁盘块或内存页并不相同）是利用了访存的空间局部性，即当前访问的位置，在未来不远的时间内再次访问其相邻位置的可能较大。这也是为了增加cache命中的手段。